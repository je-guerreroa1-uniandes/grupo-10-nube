version: '3.9'

services:

  api:
    container_name: api
    image: ghcr.io/je-guerreroa1-uniandes/grupo-10-nube/api:latest
    env_file:
      - api.env
    ports:
      - '3000:5000'
    networks:
      redproyecto:
        ipv4_address: 10.130.13.2
    volumes:
      - /nfs/general/uploads:/app/uploads
      - /nfs/general/processed:/app/processed

  jobs:
    container_name: jobs
    image: ghcr.io/je-guerreroa1-uniandes/grupo-10-nube/jobs:latest
    env_file:
      - jobs.env
    networks:
      redproyecto:
        ipv4_address: 10.130.13.3
    volumes:
      - /nfs/general/uploads:/app/uploads
      - /nfs/general/processed:/app/processed

  custom-redis:
    container_name: custom-redis
    image: ghcr.io/je-guerreroa1-uniandes/grupo-10-nube/custom-redis:latest
    ports:
      - '6379:6379'
    networks:
      redproyecto:
        ipv4_address: 10.130.13.4

#  redis-commander:
#    container_name: redis-commander
#    image: ghcr.io/joeferner/redis-commander:latest
#    restart: always
#    environment:
#      - REDIS_HOSTS=local:redis:6379:0:lOGleSPirDOLEYsiceWlemPtO
#    ports:
#      - '8082:8081'
#    networks:
#      redproyecto:
#        ipv4_address: 10.130.13.5
#    depends_on:
#      - 'custom-redis'

  custom-postgres:
    container_name: custom-postgres
    image: ghcr.io/je-guerreroa1-uniandes/grupo-10-nube/custom-postgres:latest
    ports:
      - "5433:5432"
    networks:
      redproyecto:
        ipv4_address: 10.130.13.6

  custom-nginx:
    container_name: custom-nginx
    image: ghcr.io/je-guerreroa1-uniandes/grupo-10-nube/custom-nginx:latest
    ports:
      - '8888:8888'
    networks:
      redproyecto:
        ipv4_address: 10.130.13.7
    depends_on:
      - 'api'

networks:

  redproyecto:
    ipam:
      driver: default
      config:
        - subnet: '10.130.13.0/28'